<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Simple Search Test</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="css/style.css">
</head>
<body>
    <header class="header">
        <div class="container">
            <nav class="nav">
                <div class="logo"><a href="index.html">CavaLunagroup</a></div>
                <ul class="nav-menu">
                    <li><a href="index.html">Home</a></li>
                </ul>
            </nav>
        </div>
    </header>

    <section class="page-hero">
        <div class="container">
            <h1>ğŸ” æœç´¢æµ‹è¯•é¡µé¢</h1>
            <p id="searchQuery">æµ‹è¯•æœç´¢åŠŸèƒ½</p>
        </div>
    </section>

    <section class="search-section">
        <div class="container">
            <form class="search-box" onsubmit="performSearch(event)">
                <input type="text" id="searchInput" placeholder="è¾“å…¥æœç´¢å…³é”®è¯..." value="coffee" required>
                <button type="submit">æœç´¢</button>
            </form>
        </div>
    </section>

    <section class="articles">
        <div class="container">
            <!-- è°ƒè¯•ä¿¡æ¯ -->
            <div style="background: #f0f0f0; padding: 20px; margin-bottom: 20px; border-radius: 8px;">
                <h3>è°ƒè¯•ä¿¡æ¯</h3>
                <div id="debugInfo"></div>
            </div>

            <!-- æœç´¢ç»“æœä¿¡æ¯ -->
            <div id="searchResultsInfo" class="search-results-info"></div>

            <!-- æ–‡ç« ç½‘æ ¼ -->
            <div id="articlesGrid" class="articles-grid"></div>
        </div>
    </section>

    <footer class="footer" style="margin-top: 100px;">
        <div class="container">
            <div class="footer-bottom">
                <p>ç®€åŒ–ç‰ˆæœç´¢æµ‹è¯•é¡µé¢ - CavaLunagroup</p>
            </div>
        </div>
    </footer>

    <script src="js/articles-data.js"></script>
    <script>
        // ç®€åŒ–çš„æœç´¢å‡½æ•°
        function searchArticles(query) {
            console.log('æ‰§è¡Œæœç´¢:', query);
            const searchQuery = query.toLowerCase();
            
            const results = articlesData.filter(article => {
                const searchableText = `
                    ${article.title} 
                    ${article.excerpt} 
                    ${article.categoryName}
                    ${article.author}
                `.toLowerCase();
                
                const matches = searchableText.includes(searchQuery);
                console.log(`æ–‡ç«  ${article.id} (${article.title}): ${matches ? 'âœ…åŒ¹é…' : 'âŒä¸åŒ¹é…'}`);
                
                return matches;
            });
            
            console.log('æœç´¢ç»“æœ:', results);
            return results;
        }

        // æ˜¾ç¤ºè°ƒè¯•ä¿¡æ¯
        function showDebugInfo(query, results) {
            const debugDiv = document.getElementById('debugInfo');
            debugDiv.innerHTML = `
                <div style="font-family: monospace; font-size: 14px;">
                    <p><strong>æœç´¢å…³é”®è¯:</strong> "${query}"</p>
                    <p><strong>æ€»æ–‡ç« æ•°:</strong> ${articlesData ? articlesData.length : 0}</p>
                    <p><strong>æ‰¾åˆ°ç»“æœ:</strong> ${results.length}</p>
                    <p><strong>ç»“æœID:</strong> [${results.map(r => r.id).join(', ')}]</p>
                    <br>
                    <p><strong>åŒ¹é…çš„æ–‡ç« :</strong></p>
                    <ul>
                        ${results.map(r => `
                            <li>ID ${r.id}: ${r.title} (${r.categoryName})</li>
                        `).join('')}
                    </ul>
                </div>
            `;
        }

        // æ‰§è¡Œæœç´¢
        function performSearch(event) {
            if (event) event.preventDefault();
            
            const query = document.getElementById('searchInput').value;
            document.getElementById('searchQuery').textContent = `æœç´¢: "${query}"`;
            
            console.log('===== å¼€å§‹æœç´¢ =====');
            console.log('å…³é”®è¯:', query);
            console.log('æ–‡ç« æ•°æ®:', articlesData);
            
            const results = searchArticles(query);
            
            // æ˜¾ç¤ºè°ƒè¯•ä¿¡æ¯
            showDebugInfo(query, results);
            
            // æ˜¾ç¤ºç»“æœä¿¡æ¯
            const infoDiv = document.getElementById('searchResultsInfo');
            if (results.length === 0) {
                infoDiv.innerHTML = `<p>æ²¡æœ‰æ‰¾åˆ°åŒ…å« "<strong>${query}</strong>" çš„æ–‡ç« </p>`;
            } else if (results.length === 1) {
                infoDiv.innerHTML = `<p>æ‰¾åˆ° <strong>1</strong> ç¯‡åŒ…å« "<strong>${query}</strong>" çš„æ–‡ç« </p>`;
            } else {
                infoDiv.innerHTML = `<p>æ‰¾åˆ° <strong>${results.length}</strong> ç¯‡åŒ…å« "<strong>${query}</strong>" çš„æ–‡ç« </p>`;
            }
            
            // æ˜¾ç¤ºæ–‡ç« å¡ç‰‡
            displayResults(results);
            
            console.log('===== æœç´¢å®Œæˆ =====');
        }

        // æ˜¾ç¤ºç»“æœ
        function displayResults(results) {
            const grid = document.getElementById('articlesGrid');
            grid.innerHTML = '';
            
            if (results.length === 0) {
                grid.innerHTML = `
                    <div style="grid-column: 1/-1; text-align: center; padding: 4rem 0; color: #666;">
                        <p style="font-size: 1.125rem;">æ²¡æœ‰æ‰¾åˆ°åŒ¹é…çš„æ–‡ç« </p>
                    </div>
                `;
                return;
            }
            
            results.forEach(article => {
                const card = document.createElement('article');
                card.className = 'article-card';
                card.style.opacity = '1';
                card.style.animation = 'none';
                
                card.innerHTML = `
                    <a href="article.html?id=${article.id}" class="article-link">
                        <div class="article-image" style="background: #e0e0e0; display: flex; align-items: center; justify-content: center;">
                            <span style="font-size: 3rem;">ğŸ“„</span>
                        </div>
                        <div class="article-content">
                            <div class="article-meta">
                                <span class="article-category">${article.categoryName}</span>
                                <span>â€¢</span>
                                <span class="article-date">${article.date}</span>
                            </div>
                            <h2 class="article-title">${article.title}</h2>
                            <p class="article-excerpt">${article.excerpt}</p>
                            <span class="read-more">Read More</span>
                        </div>
                    </a>
                `;
                
                grid.appendChild(card);
            });
        }

        // é¡µé¢åŠ è½½æ—¶è‡ªåŠ¨æ‰§è¡Œæœç´¢
        window.addEventListener('load', () => {
            console.log('é¡µé¢å·²åŠ è½½');
            console.log('æ–‡ç« æ•°æ®æ£€æŸ¥:', articlesData);
            console.log('æ–‡ç« æ€»æ•°:', articlesData ? articlesData.length : 0);
            
            // ä»URLè·å–æœç´¢å‚æ•°
            const urlParams = new URLSearchParams(window.location.search);
            const urlQuery = urlParams.get('q');
            
            if (urlQuery) {
                document.getElementById('searchInput').value = urlQuery;
                performSearch();
            } else {
                // é»˜è®¤æœç´¢coffee
                performSearch();
            }
        });

        // æ·»åŠ å¿«é€Ÿæµ‹è¯•æŒ‰é’®
        document.addEventListener('DOMContentLoaded', () => {
            const container = document.querySelector('.search-section .container');
            const buttonsDiv = document.createElement('div');
            buttonsDiv.style.cssText = 'margin-top: 10px; text-align: center;';
            buttonsDiv.innerHTML = `
                <button type="button" onclick="quickSearch('coffee')" style="margin: 5px; padding: 8px 16px;">æµ‹è¯•: coffee</button>
                <button type="button" onclick="quickSearch('fashion')" style="margin: 5px; padding: 8px 16px;">æµ‹è¯•: fashion</button>
                <button type="button" onclick="quickSearch('beauty')" style="margin: 5px; padding: 8px 16px;">æµ‹è¯•: beauty</button>
                <button type="button" onclick="quickSearch('garden')" style="margin: 5px; padding: 8px 16px;">æµ‹è¯•: garden</button>
                <button type="button" onclick="quickSearch('Specialty Coffee at Home')" style="margin: 5px; padding: 8px 16px;">æµ‹è¯•: å®Œæ•´æ ‡é¢˜</button>
            `;
            container.appendChild(buttonsDiv);
        });

        function quickSearch(keyword) {
            document.getElementById('searchInput').value = keyword;
            performSearch();
        }
    </script>
</body>
</html>

